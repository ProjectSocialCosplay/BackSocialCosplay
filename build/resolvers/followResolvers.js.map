{"version":3,"sources":["../../src/resolvers/followResolvers.js"],"names":["Mutation","createFollow","parent","info","followerId","models","followModel","userModel","userInfo","AuthenticationError","user","_id","follower","save","follow","findOneAndUpdate","$push","following","id","followers","deleteFollow","findByIdAndRemove","$pull","Follow","args","findOne","exec"],"mappings":"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","sourcesContent":["import {AuthenticationError} from 'apollo-server-express'\n\nexport default {\n    Mutation: {\n        /**\n         * Creates a following/follower relationship between users\n         *\n         * @param {string} userId\n         * @param {string} followerId\n         */\n        createFollow: async (parent, {followerId}, {models: {followModel, userModel}, userInfo}, info) => {\n            if (!userInfo) {\n                throw new AuthenticationError('You are not authenticated');\n            }\n            const follow = await new followModel({\n                user: userInfo._id,\n                follower: followerId,\n            }).save();\n            // Push follower/following to user collection\n            await userModel.findOneAndUpdate({_id: follow.user}, {$push: {following: follow.id}});\n            await userModel.findOneAndUpdate({_id: followerId}, {$push: {followers: follow.id}});\n\n            return follow;\n        },\n\n        /**\n         * Deletes a following/follower relationship between users\n         *\n         * @param {string} id follow id\n         */\n        deleteFollow: async (parent, {id}, {models: {followModel, userModel}, userInfo}) => {\n            if (!userInfo) {\n                throw new AuthenticationError('You are not authenticated');\n            }\n            const follow = await followModel.findByIdAndRemove(id);\n\n            // Delete follow from users collection\n            await userModel.findOneAndUpdate({_id: follow.user}, {$pull: {followers: follow.id}});\n            await userModel.findOneAndUpdate({_id: follow.follower}, {$pull: {following: follow.id}});\n            return follow;\n        },\n\n    },\n    Follow: {\n        user: async (following, args, {models: {userModel},userInfo}, info) => {\n            return  await userModel.findOne({_id: following.user}).exec()\n        },\n        follower: async (follower, args, {models: {userModel}}, info) => {\n            return await userModel.findOne({_id: follower.follower}).exec()\n        },\n    },\n};"],"file":"followResolvers.js"}