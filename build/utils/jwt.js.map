{"version":3,"sources":["../../src/utils/jwt.js"],"names":["jwt","require","AuthenticationError","module","exports","genarateToken","User","date","Date","now","sign","_id","exp","process","env","TOKEN_SECRET","checkUser","req","token","headers","verify","error","console","log","parseAuthToken","authorization","replace"],"mappings":"AAAA,MAAMA,MAAMC,QAAQ,cAAR,CAAZ;AACA,MAAO,EAACC,mBAAD,KAAwBD,QAAQ,uBAAR,CAA/B;;AAEAE,OAAOC,OAAP,CAAeC,aAAf,GAAgCC,IAAD,IAAU;AACrC,UAAMC,OAAOC,KAAKC,GAAL,EAAb;AACA,WAAOT,IAAIU,IAAJ,CAAS;AACRC,aAAKL,IADG;AAERM,aAAKL,OAAO;AAFJ,KAAT,EAIHM,QAAQC,GAAR,CAAYC,YAJT,CAAP;AAKH,CAPD;;AASAZ,OAAOC,OAAP,CAAeY,SAAf,GAA2B,gBAAgBC,GAAhB,EAAqB;AAC5C,UAAMC,QAAQD,IAAIE,OAAJ,CAAY,OAAZ,CAAd;AACA,QAAID,KAAJ,EAAW;AACP,YAAI;AACF;AACE,mBAAO,MAAMlB,IAAIoB,MAAJ,CAAWF,KAAX,EAAkBL,QAAQC,GAAR,CAAYC,YAA9B,CAAb;AACH,SAHD,CAGE,OAAOM,KAAP,EAAc;AACZC,oBAAQC,GAAR,CAAYF,KAAZ;AACA,kBAAM,IAAInB,mBAAJ,CAAwB,sCAAxB,CAAN;AACH;AACJ;AACJ,CAXD;;AAaA,SAASsB,cAAT,CAAwBC,aAAxB,EAAuC;AACnC,WAAQA,iBAAiB,IAAlB,GAA0BA,cAAcC,OAAd,CAAsB,SAAtB,EAAiC,EAAjC,CAA1B,GAAiE,IAAxE;AACH","file":"jwt.js","sourcesContent":["const jwt = require('jsonwebtoken');\nconst  {AuthenticationError} = require(\"apollo-server-express\");\n\nmodule.exports.genarateToken = (User) => {\n    const date = Date.now();\n    return jwt.sign({\n            _id: User,\n            exp: date + 604800\n        },\n        process.env.TOKEN_SECRET);\n};\n\nmodule.exports.checkUser = async function (req) {\n    const token = req.headers['token'];\n    if (token) {\n        try {\n          //  let authToken = parseAuthToken(token);\n            return await jwt.verify(token, process.env.TOKEN_SECRET);\n        } catch (error) {\n            console.log(error);\n            throw new AuthenticationError('Your session expired. Sign in again.');\n        }\n    }\n}\n\nfunction parseAuthToken(authorization) {\n    return (authorization != null) ? authorization.replace('Bearer ', '') : null;\n}"]}