{"version":3,"sources":["../../src/utils/jwt.js"],"names":["jwt","require","AuthenticationError","module","exports","genarateToken","User","date","Date","now","sign","_id","exp","process","env","TOKEN_SECRET","checkUser","req","token","headers","verify","console","log","parseAuthToken","authorization","replace"],"mappings":";;;;;;;;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACA,eAA+BA,OAAO,CAAC,uBAAD,CAAtC;AAAA,IAAQC,mBAAR,YAAQA,mBAAR;;AAEAC,MAAM,CAACC,OAAP,CAAeC,aAAf,GAA+B,UAACC,IAAD,EAAU;AACrC,MAAMC,IAAI,GAAGC,IAAI,CAACC,GAAL,EAAb;AACA,SAAOT,GAAG,CAACU,IAAJ,CAAS;AACRC,IAAAA,GAAG,EAAEL,IADG;AAERM,IAAAA,GAAG,EAAEL,IAAI,GAAG;AAFJ,GAAT,EAIHM,OAAO,CAACC,GAAR,CAAYC,YAJT,CAAP;AAKH,CAPD;;AASAZ,MAAM,CAACC,OAAP,CAAeY,SAAf;AAAA,2FAA2B,iBAAgBC,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AACjBC,YAAAA,KADiB,GACTD,GAAG,CAACE,OAAJ,CAAY,OAAZ,CADS;;AAAA,iBAEnBD,KAFmB;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAKFlB,GAAG,CAACoB,MAAJ,CAAWF,KAAX,EAAkBL,OAAO,CAACC,GAAR,CAAYC,YAA9B,CALE;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAOfM,YAAAA,OAAO,CAACC,GAAR;AAPe,kBAQT,IAAIpB,mBAAJ,CAAwB,sCAAxB,CARS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA3B;;AAAA;AAAA;AAAA;AAAA;;AAaA,SAASqB,cAAT,CAAwBC,aAAxB,EAAuC;AACnC,SAAQA,aAAa,IAAI,IAAlB,GAA0BA,aAAa,CAACC,OAAd,CAAsB,SAAtB,EAAiC,EAAjC,CAA1B,GAAiE,IAAxE;AACH","sourcesContent":["const jwt = require('jsonwebtoken');\nconst  {AuthenticationError} = require(\"apollo-server-express\");\n\nmodule.exports.genarateToken = (User) => {\n    const date = Date.now();\n    return jwt.sign({\n            _id: User,\n            exp: date + 604800\n        },\n        process.env.TOKEN_SECRET);\n};\n\nmodule.exports.checkUser = async function (req) {\n    const token = req.headers['token'];\n    if (token) {\n        try {\n          //  let authToken = parseAuthToken(token);\n            return await jwt.verify(token, process.env.TOKEN_SECRET);\n        } catch (error) {\n            console.log(error);\n            throw new AuthenticationError('Your session expired. Sign in again.');\n        }\n    }\n}\n\nfunction parseAuthToken(authorization) {\n    return (authorization != null) ? authorization.replace('Bearer ', '') : null;\n}"],"file":"jwt.js"}